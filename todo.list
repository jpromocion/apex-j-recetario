
      -SIGUIENTE VERSION V1.3:

        --Mensaje al guardado:
          --que el mensaje de vuelta se cierre solo pasado unos segundos

        -filtro peronsas: como un rango op un slider

        -carrosule de fotos??
          https://oracle-max.com/carrusel-de-imagenes-dinamico-en-oracle-apex/
          https://oracle-max.com/como-hacer-un-api-restful-en-oracle-apex-que-nos-devuelva-una-imagen-en-su-request/

        -Buscador: formato cards -> muestra la primera foto de la receta como imagen del card

        -conversor ml a floz -> por mi peso -> crear una pantalla para converores en genral!!!

@XAKI: creada tabla, funcion, parece funciona -> crear formulario mantenimiento, y luego formulario para conversion

select converterMesure('onza liquida estadounidense (floz)','kilogramo (kg)',33.814) as valor from dual;

https://miconvertidor.com/masa/
mililitros (ml) <-> litros (l)
              1 <-> 0,001
mililitros (ml) <-> centimetro cúbico (cc)
              1 <-> 1
mililitros (ml) <-> metro cúbico (cc)
              1 <-> 0.000001
mililitros (ml) <-> onza liquida estadounidense (floz)
              1 <-> 0,033814
mililitros (ml) <-> galón(gal)
              1 <-> 0.000264
mililitros (ml) <-> cuarto
              1 <-> 0.00106
mililitros (ml) <-> pinta
              1 <-> 0.00211
mililitros (ml) <-> cucharada (cs)
              1 <-> 0,0666666667
mililitros (ml) <-> cuchararilla de postre
              1 <-> 0,1
mililitros (ml) <-> cuchararilla de café
              1 <-> 0,2
mililitros (ml) <-> taza (cup)
              1 <-> 0.004
mililitros (ml) <-> taza café
              1 <-> 0,01
mililitros (ml) <-> vaso agua
              1 <-> 0,005
mililitros (ml) <-> vaso vino
              1 <-> 0,01


gramos (gr) <-> kilogramo (kg)
          1 <-> 0,001
gramos (gr) <-> miligramo (mg)
          1 <-> 1000
gramos (gr) <-> libra (lb)
          1 <-> 0,00220462
gramos (gr) <-> onza (oz)
          1 <-> 0,035274

create table CONVERTER (
    id number generated by default on null as identity,
    measure_base varchar2(500) not null,
    measure_destination varchar2(500) not null,
    ratio_to_1 number(20,10) not null,
    created date not null,
    created_by varchar2(255 char) not null,
    updated date not null,
    updated_by varchar2(255 char) not null
);

alter table CONVERTER add constraint CONVERTER_PK primary key (id);

create or replace trigger CONVERTER_BIU
    before insert or update
    on CONVERTER
    for each row
begin
    if inserting then
        :new.created := sysdate;
        :new.created_by := coalesce(sys_context('APEX$SESSION','APP_USER'),user);
    end if;
    :new.updated := sysdate;
    :new.updated_by := coalesce(sys_context('APEX$SESSION','APP_USER'),user);
end CONVERTER_BIU;
/


PROMPT Insercion inicial en MEASURE
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'litros (l)', 0.001);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'centimetro cúbico (cc)', 1);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'metro cúbico (cc)', 0.000001);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'onza liquida estadounidense (floz)', 0.033814);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'galón(gal)', 0.000264);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'cuarto', 0.00106);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'pinta', 0.00211);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'cucharada (cs)', 0.0666666667);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'cuchararilla de postre', 0.1);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'cuchararilla de café', 0.2);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'taza (cup)', 0.004);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'taza café', 0.01);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'vaso agua', 0.005);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('mililitros (ml)', 'vaso vino', 0.01);

insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('gramos (gr)', 'kilogramo (kg)', 0.001);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('gramos (gr)', 'miligramo (mg)', 1000);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('gramos (gr)', 'libra (lb)', 0.00220462);
insert into CONVERTER (measure_base, measure_destination,ratio_to_1)
values('gramos (gr)', 'onza (oz)', 0.035274);


select measure_base as name, 1 as grupo
from converter
union
select measure_destination as name, 2 as grupo
from converter
order by 1;


CREATE OR REPLACE FUNCTION converterMesure(
      measure1 CONVERTER.MEASURE_BASE%TYPE,
      measure2 CONVERTER.MEASURE_BASE%TYPE,
      value NUMBER)
RETURN NUMBER IS
  res NUMBER := NULL;
  rConverter_ CONVERTER%ROWTYPE;
  rConverter2_ CONVERTER%ROWTYPE;
  encontrado BOOLEAN := FALSE;

BEGIN

  <<directa>>
  BEGIN
    SELECT *
    INTO rConverter_
    FROM CONVERTER
    WHERE
      (
        (measure_base = measure1 and measure_destination = measure2)
        or
        (measure_base = measure2 and measure_destination = measure1)
      );
    encontrado := TRUE;
    IF rConverter_.measure_base = measure1 THEN
      res := value * rConverter_.ratio_to_1;
    ELSE
      res := value / rConverter_.ratio_to_1;
    END IF;
  EXCEPTION
    WHEN NO_DATA_FOUND THEN
      encontrado := FALSE;
  END directa;

  IF NOT encontrado THEN

    <<diferida>>
    BEGIN
      SELECT *
      INTO rConverter_
      FROM CONVERTER
      WHERE measure_destination = measure1;

      SELECT *
      INTO rConverter2_
      FROM CONVERTER
      WHERE measure_destination = measure2
        AND measure_base = rConverter_.measure_base;

      encontrado := TRUE;
      res := value / rConverter_.ratio_to_1;
      res := res * rConverter2_.ratio_to_1;

    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        encontrado := FALSE;
    END diferida;

  END IF;

  RETURN res;
END;
/




        -nuevo filtro en buscador: dificultad

        -globalizar pudiendo cambiar a ingles

        -una exportacion a un pdf de una receta -> por si hubiera que sacarlas todas...

        -recetas con videoos de referencia... o enlaces
          -ahcer una partado de medios mas completo
          -poder reproducir el video yutube dentro??


